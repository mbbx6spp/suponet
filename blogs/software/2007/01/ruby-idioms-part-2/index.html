

  
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html">
  <link href="/images/favicon.ico" rel="shortcut icon">
  <meta content="width=device-width, minimum-scale=1.0, maximum-scale=1.5" name="viewport">
  <title>Susan Potter: Ruby Idioms, Part 2</title>
  <link rel="stylesheet" type="text/css" href="/stylesheets/reset.css">
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="/stylesheets/styles.css">
  <link rel="stylesheet" type="text/css" href="/stylesheets/coderay.css">


  
    <header>
  <div class="container">
    <a href="/">
      <img alt="Susan Potter" height="30" src="/images/logo.png" width="128">
    </a>
    <nav>
      <a href="/about/">About</a>
      <a href="/resume/">Resume</a>
      <a href="/portfolio/">Portfolio</a>
      <a href="/talks/">Talks</a>
      <a href="/contact/">Contact</a>
      <a target="_blank" id="twitter" class="icon" href="https://twitter.com/SusanPotter"><img src="/images/twitter.png" height="30" width="30" alt="@SusanPotter's Twitter feed"></a>
      <a target="_blank" id="linked" class="icon" href="https://www.linkedin.com/in/susanpotter"><img src="/images/linkedin.png" height="30" width="30" alt="Susan Potter's LinkedIn profile"></a>
      <a target="_blank" id="github" class="icon" href="https://github.com/mbbx6spp"><img src="/images/github.png" height="30" width="30" alt="Susan Potter's GitHub open source code repository profile"></a>
    </nav>
  </div>
</header>


    <div class="text post sidebar">
      <aside class=".hidden-xs .hidden-sm">
        <ul class="share-buttons">
          <li class="twitter"><a href="https://twitter.com/share" class="twitter-share-button" data-count="vertical" data-via="SusanPotter">Tweet</a></li>
          <li class="plusone">
          <li class="linked">
<script type="text/javascript" src="https://platform.linkedin.com/in.js"></script><script type="in/share" data-counter="top"></script>
</li>
        </ul>
      </aside>
      <section>
        <article>
          <h1 class="banner">
            Software Development Blog <small>(formerly called 'Snakes, Gems &amp; Coffee')</small>
            <span class="description">
              A technical blog with articles on a number of topics from Erlang, Ruby idioms, Javascript,
              semantic web, Rails tips, graph databases, distributed systems.
            </span>
          </h1>
          
          <h2>Ruby Idioms, Part 2</h2>
          <h5 class="time">2007-01-22 19:21:00 -0600</h5>
          Now the "idiom" we will use is not specific to Ruby, since I am pretty sure Perl has one of the  constructs we will use to solve the stated problem, but it is still idiomatic, since the majority of popular OO languages (static, dynamic or otherwise) do not have it (as far as I know).  Also some consider this to be a sub-optimal idiom, because there is a terser way to do something like this.  However, the idiom I recommend below is much more multi-purpose, though I will show the terser version for the trivial case.

Firstly our Javafied Ruby code looks like the following for the problem at hand:
%pre
  :preserve
    
    if not var
      var = "some text string"
    end
    # OR for a pure Java to Ruby translation with ZERO Rubification
    if nil == var # of course "if var == nil" is equivalent too.
      var = "some text string"
    end
Now this is the most trivial case of wanting to set a variable to a value only when it is
= succeed "." do
  %code nil
The Ruby idiom I advocate is much more multi-purpose than this trivial case, but there is an even terser Ruby idiom that is only applicable to this case, which I wanted to show you first.  See below:
%pre
  :preserve
    
    var ||= "some text string"
As you can see this is very terse, but my question is, is it readable?  Well to many Rubyists it is, but this relies on expressionistic understanding of how Ruby works under the covers.  On projects involving developers with varied skill levels, I would definitely prefer my proposal below.

Now onto the more readable and more multi-purpose idiom that reads much more like my natural language (which is my preference in general):
%pre
  :preserve
    
    var = "some text string" unless var
Now some of you may think this isn't as readable as it could be, I concur.  I sometimes prefer to use something like the following, but consistency on a project is important in my view, so pick on and go with it:
%pre
  :preserve
    
    var = "some text string" if var.nil?
Again it reads more naturally, at least to an English speaker.

But I will admit I have found myself using the terser "or equals" idiom in favor of the above for the trivial case (but consistently on projects with other advanced Ruby developers).  However, the "if var nil?" idiom can be used in more multi-purpose situations, not only when you wish to set a variable when it has a
%code nil
value (that is null to you Java heads).

A non-trivial usage of the "unless" version of the idiom would be well suited to a code snippet that tries to do the following:
%pre
  :preserve
    
    user_defined_fruits = ['apple', 'cantaloupe']
    fruits = ['apple', 'banana']
    user_defined_fruits.each do |fruit|
      if fruits.include? fruit
        fruits &lt;&lt; fruit
      end
    end
    fruits #=&gt; ['apple', 'banana', 'cantaloupe'] NOT ['apple', 'banana', 'apple', 'cantaloupe']
Now a better way of doing this with the "unless" version of the idiom would be:
%pre
  :preserve
    
    user_defined_fruits = ['apple', 'cantaloupe']
    fruits = ['apple', 'banana']
    user_defined_fruits.each do |fruit|
      fruits &lt;&lt; fruit unless fruits.include? fruit
    end
As you see above the code is terser, while being as readable, if not more (in my opinion again).  To me it feels much more like my natural language, which in my view is the thing to aim for.

Again the as-terse-as-possible enthusiasts will love the following:
%pre
  :preserve
    
    user_defined_fruits = ['apple', 'cantaloupe']
    fruits = ['apple', 'banana']
    fruits |= user_defined_fruits

        </article>
      </section>
    </div>
    <footer>
  <p>
    Copyright Â© 2006-2018 <a href="//susanpotter.net">Susan Potter</a>.
  </p>
  <p>
    This website is developed by <a href="//susanpotter.net">Susan Potter</a>.
  </p>
  <div id="rights">
    <a href="//susanpotter.net">Susan Potter</a> reserves all rights to the copy and intellectual rights that are presented on this website as original material to <a href="//susanpotter.net">Susan Potter</a>.
    Links: <a href="//susanpotter.net/resume/software-engineering/">Software Engineer Extraordinaire</a>,
           <a href="//susanpotter.net/resume/software-engineering/">Software Developer Extraordinaire</a>,
           <a href="//susanpotter.net/resume/software-engineering/">Software Engineer</a>,
           <a href="//susanpotter.net/resume/architect/">Application architect/</a>,
           <a href="//susanpotter.net/resume/software-engineering/">Ruby Software Engineer</a>,
           <a href="//susanpotter.net/resume/software-engineering/">Ruby Engineer</a>,
           <a href="//susanpotter.net/resume/software-engineering/">Ruby on Rails Engineer</a>,
           <a href="//susanpotter.net/resume/software-engineering/">Ruby on Rails Software Engineer</a>,
           <a href="//susanpotter.net/resume/software-engineering/">Software Developer</a>,
           <a href="//susanpotter.net/resume/architect/">Software architect/</a>,
           <a href="//susanpotter.net/resume/software-engineering/">Hedge Fund Software Engineer</a>,
           <a href="//susanpotter.net/resume/software-engineering/">Hedge Fund Software Developer</a>,
           <a href="//susanpotter.net/">Web Services Software Engineer</a>,
           <a href="//susanpotter.net/">Web Services Software Developer</a>,
           <a href="//susanpotter.net/">Web Services Engineer</a>,
           <a href="//susanpotter.net/">Web Services Developer</a>,
           <a href="//susanpotter.net/resume/restful-design/">REST Software Engineer</a>,
           <a href="//susanpotter.net/resume/restful-design/">REST Software Developer</a>,
           <a href="//susanpotter.net/resume/restful-design/">Resource Oriented architect/ure</a>,
  </div>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-837842-1', 'auto');
    ga('require', 'displayfeatures');
    ga('send', 'pageview');
  </script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.6/jquery.min.js"></script>
  
  
  <script async="async" defer src="/javascripts/app.js"></script>
  <script>
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>
</footer>

    <script type="text/javascript">
      (function($) {
        var btns = $('.share-buttons .plusone').html('<g:plusone size="tall"></g:plusone>');
        var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
        po.src = 'https://apis.google.com/js/plusone.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
      })(jQuery);
    </script>
    <!-- Place this tag just before your close body tag -->
  

