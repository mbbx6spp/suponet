

  
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html">
  <link href="/images/favicon.ico" rel="shortcut icon">
  <meta content="width=device-width, minimum-scale=1.0, maximum-scale=1.5" name="viewport">
  <title>Susan Potter: Stupid Easy: 7 Deadly [Rails] Sins, Part 2</title>
  <link rel="stylesheet" type="text/css" href="/stylesheets/reset.css">
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="/stylesheets/styles.css">
  <link rel="stylesheet" type="text/css" href="/stylesheets/coderay.css">


  
    <header>
  <div class="container">
    <a href="/">
      <img alt="Susan Potter" height="30" src="/images/logo.png" width="128">
    </a>
    <nav>
      <a href="/about/">About</a>
      <a href="/resume/">Resume</a>
      <a href="/portfolio/">Portfolio</a>
      <a href="/talks/">Talks</a>
      <a href="/contact/">Contact</a>
      <a target="_blank" id="twitter" class="icon" href="https://twitter.com/SusanPotter"><img src="/images/twitter.png" height="30" width="30" alt="@SusanPotter's Twitter feed"></a>
      <a target="_blank" id="linked" class="icon" href="https://www.linkedin.com/in/susanpotter"><img src="/images/linkedin.png" height="30" width="30" alt="Susan Potter's LinkedIn profile"></a>
      <a target="_blank" id="github" class="icon" href="https://github.com/mbbx6spp"><img src="/images/github.png" height="30" width="30" alt="Susan Potter's GitHub open source code repository profile"></a>
    </nav>
  </div>
</header>


    <div class="text post sidebar">
      <aside class=".hidden-xs .hidden-sm">
        <ul class="share-buttons">
          <li class="twitter"><a href="https://twitter.com/share" class="twitter-share-button" data-count="vertical" data-via="SusanPotter">Tweet</a></li>
          <li class="plusone">
          <li class="linked">
<script type="text/javascript" src="https://platform.linkedin.com/in.js"></script><script type="in/share" data-counter="top"></script>
</li>
        </ul>
      </aside>
      <section>
        <article>
          <h1 class="banner">
            Software Development Blog <small>(formerly called 'Snakes, Gems &amp; Coffee')</small>
            <span class="description">
              A technical blog with articles on a number of topics from Erlang, Ruby idioms, Javascript,
              semantic web, Rails tips, graph databases, distributed systems.
            </span>
          </h1>
          
          <h2>Stupid Easy: 7 Deadly [Rails] Sins, Part 2</h2>
          <h5 class="time">2008-01-22 09:43:00 -0600</h5>
          In the second part of
= succeed "," do
  %a{:href =&gt; "http://snakesgemscoffee.blogspot.com/2008/01/stupid-easy-7-deadly-rails-sins-part-1.html"} Stupid Easy: 7 Deadly [Rails] Sins
we look at sins four through six and save the most heinous sin for last in the third part of this series.
%h4 4. Stupid Easy Views
Everyone has seen spaghetti view code, either in the JSP, PHP, or other similar web templating environments.  So why do people honestly think (ok, only the no-thinkers) that when they use Rails that you can't violate MVC because it is built around the MVC "pattern".  Don't even get me started on the whole "pattern" thing...

If you see a piece of view code like the following, then you are violating MVC.  Yes, even when using Rails:
%pre
  %code
    :preserve
      
      &lt;% 
      if current_user &amp;&amp; current_user.admin?
        @somevar = something goes here
        # and do something else here
      else
        @somevar = something else goes here
      end
      %&gt;
This is a small (but very stupid) violation, but a violation none-the-less.  I have seen not just logic in view code, but oddly model-specific code (in one case I even saw some attributes of a model being updated at the END of the view template - go figure).  Now simply checking the admin flag of the
%code current_user
to insert some view specific code, would not be violating MVC.

There are various ways of making sure you don't make this mistake.  Some people think using a specialized templating language in place of eRB is the way to go (one of the many potential replacements that I happen to know about is
= succeed ")." do
  %a{:href =&gt; "http://haml.hamptoncatlin.com/"} Haml
These specialized template languages basically make it virtually impossible to embed any kind of logic into the view code.  Others (pro-thinkers, rather than no-thinkers) don't believe that level of enforcement is necessary and just make a point of highlighting to the team (and then quickly refactoring) any violations in view code to educate all the team members about this sin.

I have even seen some Rake tasks written (ok, I may have written a couple) that flag any views that have specific keywords within the  eRB brackets as potential violators so that we can look through the suspects and make judgments before a release is made (because you never want to release code that violate basic principles you believe in).  Another strategy is to only work with developers that you share a very similar development philosophy and know they wouldn't violate this basic rule of thumb in the first place.

In any case, you need to incorporate one of these strategies so you can be sure to be rid of the Stupid Easy View
%b faux pas
in Rails projects.
%h4 5. Stupid Easy Configuration (and Routes)
In Rails 2.0 there is absolutely ZERO excuse for this (with very nice initializer hooks available), but even pre-2.0 it is hard to justify an
%code config/environment.rb
consisting of more than 30 lines (including basic Rails configuration minus comments).

Separation of configuration into separate files that are required by
%code config/environment.rb
were my personal preference in pre-2.0.

On the
%code config/routes.rb
side, I would often see the default routes still uncommented.  In Rails post-1.2 there is really no excuse since almost everyone should be using RESTful routes with RESTful controllers (even if the way Rails generates a ridiculous amount of code, when it could be refactored nicely into a mixin or base class, is pretty dumb) anyway.  In fact, default routes are almost always an invitation for troublemakers to hack into your site (especially if they know it is a Rails site).  I can't say I have never deployed a Rails 1.2.x site with default routes uncommented, but I certainly haven't in the last year since Rails 1.2's official release.
%h4 6. Stupid Easy Library Code
For some reason numerous popular Rails plugins promote the idea of putting generated files into your
%code RAILS_ROOT/lib
directory (e.g. acts_as_authentication, restful_authentication, etc.).  Instead of being a real plugin they are basically just Rails generators.  Now we could debate how generators could be better supported in Rails, but that is really a tangent to the point.  Don't be fooled by these popular "plugins" (remember they are really only generators).

If you have
%b significant
code in your
%code RAILS_ROOT/lib
that has the same focus (e.g. authentication, authorization, credit card processing, etc.), then you really ought to create your own plugin (even if it isn't going to be shared with other projects in the foreseeable future).  How you and/or your team defines
%b "significant"
is a judgment call, but I personally think any unit of code that works together that is greater than 200 lines of elegant Ruby code is significant (minus empty lines and comments of course).  It isn't necessarily a hard or fast rule, but a general rule of thumb, which may have exceptions.

The main purpose of this is twofold from my perspective.  When you have a lot of code in your
%code RAILS_ROOT/lib
it is a harder to be more disciplined about organization.  Whereas with a plugin you know where plugin initialization code goes vs. mixin or other code.  Another big benefit (which is related to code organization) is testing/specing.  It is much easier to see (or specifically notice) test/spec-coverage shortcomings of plugins than holes in your tests/specs for
%code RAILS_ROOT/lib
code.

Benefits of creating plugins include that it is forces you (the developer) to think more about:
%ul
  %li Testing/specing your code
  %li code organization from a maintainability perspective
  %li what chunks of code go together (should this be one or two plugins)
  %li the scope of your plugin vs. what needs to be defined or written in your application code
  %li who is responsible for developing this functionality, maybe it is the infrastructure/core/framework development team who needs to be responsible for authentication or authorization code rather than application developers.  With plugins you can separate our these responsibilities very easily
In addition, a plugin is much more easily shareable across projects (in a more organized and disciplined way than just copying or even linking files/directories into your
%code RAILS_ROOT/lib
directory).

Of course, I also find the way Rails plugins are supported by Rails a hindrance, especially when RubyGems
%b could
provide a many facilities to support this in a more elegant way, but that is a topic for another day!:)

There is only one Stupid Easy Deadly [Rails] Sin left, which I will publish in the next two weeks.

        </article>
      </section>
    </div>
    <footer>
  <p>
    Copyright Â© 2006-2018 <a href="//susanpotter.net">Susan Potter</a>.
  </p>
  <p>
    This website is developed by <a href="//susanpotter.net">Susan Potter</a>.
  </p>
  <div id="rights">
    <a href="//susanpotter.net">Susan Potter</a> reserves all rights to the copy and intellectual rights that are presented on this website as original material to <a href="//susanpotter.net">Susan Potter</a>.
    Links: <a href="//susanpotter.net/resume/software-engineering/">Software Engineer Extraordinaire</a>,
           <a href="//susanpotter.net/resume/software-engineering/">Software Developer Extraordinaire</a>,
           <a href="//susanpotter.net/resume/software-engineering/">Software Engineer</a>,
           <a href="//susanpotter.net/resume/architect/">Application architect/</a>,
           <a href="//susanpotter.net/resume/software-engineering/">Ruby Software Engineer</a>,
           <a href="//susanpotter.net/resume/software-engineering/">Ruby Engineer</a>,
           <a href="//susanpotter.net/resume/software-engineering/">Ruby on Rails Engineer</a>,
           <a href="//susanpotter.net/resume/software-engineering/">Ruby on Rails Software Engineer</a>,
           <a href="//susanpotter.net/resume/software-engineering/">Software Developer</a>,
           <a href="//susanpotter.net/resume/architect/">Software architect/</a>,
           <a href="//susanpotter.net/resume/software-engineering/">Hedge Fund Software Engineer</a>,
           <a href="//susanpotter.net/resume/software-engineering/">Hedge Fund Software Developer</a>,
           <a href="//susanpotter.net/">Web Services Software Engineer</a>,
           <a href="//susanpotter.net/">Web Services Software Developer</a>,
           <a href="//susanpotter.net/">Web Services Engineer</a>,
           <a href="//susanpotter.net/">Web Services Developer</a>,
           <a href="//susanpotter.net/resume/restful-design/">REST Software Engineer</a>,
           <a href="//susanpotter.net/resume/restful-design/">REST Software Developer</a>,
           <a href="//susanpotter.net/resume/restful-design/">Resource Oriented architect/ure</a>,
  </div>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-837842-1', 'auto');
    ga('require', 'displayfeatures');
    ga('send', 'pageview');
  </script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.6/jquery.min.js"></script>
  
  
  <script async="async" defer src="/javascripts/app.js"></script>
  <script>
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>
</footer>

    <script type="text/javascript">
      (function($) {
        var btns = $('.share-buttons .plusone').html('<g:plusone size="tall"></g:plusone>');
        var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
        po.src = 'https://apis.google.com/js/plusone.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
      })(jQuery);
    </script>
    <!-- Place this tag just before your close body tag -->
  

